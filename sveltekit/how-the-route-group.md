# ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ— (auth)/ ã®ä»•çµ„ã¿

SvelteKit ã® **ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ— `()`** ã¨ **`guard` ã‚„ `interceptor` çš„ãªä»•çµ„ã¿** ã®é–¢ä¿‚ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚

## ğŸ”¹ ãƒ«ãƒ¼ãƒˆã‚°ãƒ«ãƒ¼ãƒ— `(auth)/` ã®ä»•çµ„ã¿

ä»¥ä¸‹ã®ã‚ˆã†ã« `()` ã§å›²ã£ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã¯ **ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ç”¨ï¼ˆæ§‹é€ ä¸Šã®æ•´ç†ç”¨ï¼‰** ã§ã‚ã‚Šã€
ğŸ“ **URL ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“**ã€‚

```plaintext
src/routes/
â”œâ”€â”€ (auth)/               
â”‚   â”œâ”€â”€ login/    â†’ `/login`
â”‚   â””â”€â”€ register/ â†’ `/register`
```

âœ… ã¤ã¾ã‚Š **ã€ŒURL ã«ã¯ `/auth` ã¨ã„ã†éƒ¨åˆ†ã¯å«ã¾ã‚Œãšã€è¦‹ãŸç›®ã ã‘ã®ãƒ•ã‚©ãƒ«ãƒ€æ•´ç†ã€** ã§ã™ã€‚

## ğŸ”¹ guard / interceptor çš„æŒ™å‹•ã¯ï¼Ÿ

SvelteKit ã«ã¯ **ã€Œå…¬å¼ã® `guard` / `interceptor` æ©Ÿèƒ½ã€ã¯å­˜åœ¨ã—ã¾ã›ã‚“**ã€‚
ã—ã‹ã—ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã§ãã¾ã™ï¼š

### 1ï¸âƒ£ **`+layout.server.ts` / `+layout.ts` ã‚’ä½¿ã£ãŸ guard çš„å‡¦ç†**

ä¾‹ãˆã°ã€`(auth)/` ãƒ«ãƒ¼ãƒˆã«å…±é€šã® `+layout.server.ts` ã‚’ç½®ã‘ã°ã€
ãã®ä¸­ã§ `session` ãƒã‚§ãƒƒã‚¯ï¼ˆèªè¨¼ãƒ»èªå¯ï¼‰ã‚’è¡Œã„ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãªã©ãŒã§ãã¾ã™ã€‚

```plaintext
src/routes/
â”œâ”€â”€ (auth)/
â”‚   â”œâ”€â”€ +layout.server.ts  â† ã“ã“ã« guard çš„å‡¦ç†
â”‚   â”œâ”€â”€ login/
â”‚   â””â”€â”€ register/
```

ã“ã® `+layout.server.ts` ã¯ `(auth)/` é…ä¸‹ã®å…¨ãƒšãƒ¼ã‚¸ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚

### 2ï¸âƒ£ **guard çš„å‡¦ç†ã®å®Ÿè£…ä¾‹**

```ts
// src/routes/(auth)/+layout.server.ts
import type { LayoutServerLoad } from './$types';
import { redirect } from '@sveltejs/kit';

export const load: LayoutServerLoad = async ({ locals, url }) => {
  const user = locals.user;

  if (!user) {
    throw redirect(302, `/login?redirectTo=${url.pathname}`);
  }

  return { user };
};
```

ã“ã®ã‚ˆã†ã« **`+layout.server.ts` ãŒ `guard` ã®å½¹å‰²ã‚’æœãŸã™** ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

## ğŸ”¹ è¨­å®šå ´æ‰€ã¾ã¨ã‚

| ç”¨é€”            | è¨­å®šå ´æ‰€                                           |
| ------------- | ---------------------------------------------- |
| èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆguardï¼‰ | `+layout.server.ts` ã¾ãŸã¯ `+layout.ts`ï¼ˆãƒšãƒ¼ã‚¸å˜ä½ã‚‚OKï¼‰ |
| API èªè¨¼        | `+server.ts` å†…ã§ç›´æ¥ `locals` ãªã©ã‚’ç¢ºèª               |

âœ… **ãƒã‚¤ãƒ³ãƒˆã¾ã¨ã‚**

* `()` ã¯ãƒ•ã‚©ãƒ«ãƒ€æ•´ç†ã®ãŸã‚ã ã‘ â†’ URL ã«ã¯å‡ºãªã„ã€‚
* `guard` / `interceptor` ã¯ `+layout.server.ts` ã‚’è©²å½“ã‚°ãƒ«ãƒ¼ãƒ—ã«é…ç½®ã—ã¦å®Ÿè£…ã™ã‚‹ã€‚
* `locals` ã«èªè¨¼æƒ…å ±ã‚’ã‚»ãƒƒãƒˆã—ã¦ãŠã‘ã°ã€ `load` ã§ç¢ºèªã§ãã‚‹ã€‚

